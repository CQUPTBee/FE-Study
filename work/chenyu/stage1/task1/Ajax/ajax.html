<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Ajax</title>
	<script type="text/javascript">
			//console.log(window.a);//undefined
			//console.log(a);//Uncaught ReferenceError: a is not defined
			function ajax(url,fnsuccess,fnfailed){
				var Btn=document.getElementById('btn1');
				Btn.onclick=function(){
				//1.创建Ajax对象
				var oAjax=null;
				if(window.XMLHttpRequest){
					//window.XMLHttpRequest为IE6兼容
//console.log(window.a);//undefined
//console.log(a);//Uncaught ReferenceError: a is not defined
//用一个不存在的变量的时候，出错
//用一个不存在的属性的时候，undefined	
	
					oAjax=new XMLHttpRequest();

				}else{
					oAjax=new ActiveXObject("Microsoft.XMLHTTP");
				}
				//alert(oAjax);


				//2.连接服务器
				//open(方法，url,是否异步);
				oAjax.open('GET',url,true);
				//3.发送请求
				oAjax.send();
				//4.接收返回
				oAjax.onreadyststechange=function(){
					if(oAjax.readyState==4){
						if(oAjax.status==200){
							//console.log('成功！'+oAjax.responseText);
							//oAjax.responseText文件里面的内容
							fnsuccess(oAjax.responseText);
							//服务器的返回值

						}else{
							//console.log('失败！');
							if(fnfailed){//是否关心失败
								fnfailed();
							}
							

						}
					}


				}


				};


			};






	</script>
</head>
<body>
	ActiveX
	<input type="button" id="btn1" value="读取文件"/>
</body>
</html>